# Implementation Plan

- [-] 1. Set up camera permissions and VisionKit foundation in Swift
  - Add camera usage description to Info.plist for affordability scanning
  - Import VisionKit, AVFoundation, and Apple Foundation Models frameworks in Swift
  - Create basic Swift camera permission handling with graceful fallback
  - _Requirements: 1.1, 2.1, 5.3_

- [x] 2. Extend existing data models for camera affordability features
  - [x] 2.1 Add camera-specific properties to existing models
    - Extend existing Category enum with camera detection confidence tracking
    - Add affordability result properties to work with existing Transaction model
    - Create minimal DetectedObject struct that maps to existing Category system
    - Write unit tests for extended model functionality
    - _Requirements: 1.2, 6.1_

  - [x] 2.2 Create affordability result structures using existing budget data
    - Build AffordabilityResult struct that works with existing Budget and BudgetViewModel
    - Add AI reasoning properties that integrate with current budget calculations
    - Extend existing budget tracking to include AI-powered recommendations
    - Write unit tests for affordability results with existing budget data
    - _Requirements: 4.2, 6.2_

- [ ] 3. Build VisionKit camera interface foundation in Swift
  - [ ] 3.1 Create Swift CameraAffordabilityView with full-screen interface
    - Implement SwiftUI camera preview using AVCaptureSession in Swift
    - Add camera overlay with Penny's neo-brutalist design system using SwiftUI
    - Integrate Swift haptic feedback for object detection events
    - Write SwiftUI previews and basic Swift interaction tests
    - _Requirements: 1.1, 5.5_

  - [ ] 3.2 Implement Swift VisionProcessor for object detection
    - Set up VNImageRequestHandler for real-time object detection in Swift
    - Configure VNCoreMLRequest for object classification using Swift
    - Add Swift confidence threshold handling and error recovery
    - Create Swift unit tests with mock camera input data
    - _Requirements: 1.2, 5.1, 5.2_

- [ ] 4. Integrate Apple Foundation Models (GPT-5) for affordability intelligence
  - [ ] 4.1 Set up Apple Foundation Models framework in Swift for on-device affordability analysis
    - Import Apple Foundation Models framework in Swift and configure GPT-5 models for on-device AI processing
    - Implement Swift Foundation Models integration for spending pattern analysis and affordability decisions
    - Create Swift affordability reasoning engine using Apple's GPT-5 on-device AI capabilities
    - Add Swift unit tests for Apple Foundation Models integration and response handling
    - _Requirements: 2.1, 6.3_

  - [ ] 4.2 Build Swift Foundation Models-powered affordability decision engine
    - Implement Swift affordability calculation logic using Apple Foundation Models GPT-5 for contextual analysis
    - Integrate Foundation Models responses with existing Swift BudgetViewModel budget data
    - Add natural language affordability explanations generated by Apple Foundation Models GPT-5 in Swift
    - Create comprehensive Swift unit tests for Foundation Models affordability decisions
    - _Requirements: 1.3, 4.1, 6.4_

- [ ] 5. Create AI-first affordability calculation system using existing BudgetViewModel
  - [ ] 5.1 Implement Swift CameraAffordabilityViewModel that extends existing system
    - Create Swift ObservableObject that coordinates VisionKit with existing BudgetViewModel
    - Use existing Swift budget calculations and enhance with Apple Foundation Models GPT-5 affordability logic
    - Add real-time Swift processing pipeline that leverages current Transaction and Budget models
    - Write Swift integration tests using existing budget data structures
    - _Requirements: 1.3, 2.2_

  - [ ] 5.2 Enhance existing Swift budget system with Apple Foundation Models GPT-5 recommendations
    - Extend existing Swift BudgetViewModel with Apple Foundation Models GPT-5 affordability calculation methods
    - Use existing Swift Category and Budget structures with Foundation Models for enhanced spending analysis
    - Add Foundation Models GPT-5 generated smart recommendations that work with current Swift budget tracking system
    - Write Swift unit tests that validate Apple Foundation Models enhancements with existing budget scenarios
    - _Requirements: 6.1, 6.2, 6.3_

- [ ] 6. Design and implement result presentation system
  - [ ] 6.1 Create slide-up result card with color-coded feedback
    - Build SwiftUI slide-up card with spring animations
    - Implement color-coded affordability indicators (green/red)
    - Add sophisticated blur effects matching Penny's design system
    - Create accessibility support with VoiceOver integration
    - _Requirements: 1.4, 4.3_

  - [ ] 6.2 Implement detailed affordability information display
    - Show AI reasoning and natural language explanations
    - Display budget impact on AI-optimized spending limits
    - Add contextual recommendations and alternative suggestions
    - Create expandable detail sections with progressive disclosure
    - _Requirements: 4.2, 4.4_

- [ ] 7. Build effortless transaction integration using existing Transaction system
  - [ ] 7.1 Implement "Add to Budget" quick action with existing models
    - Use existing Transaction model and BudgetViewModel.addTransaction() method
    - Pre-populate existing AddTransactionView with AI-detected category and estimated price
    - Integrate with existing Apple Pay-style transaction entry interface
    - Write integration tests using existing transaction creation flow
    - _Requirements: 3.2, 3.4_

  - [ ] 7.2 Integrate with existing spending streak system
    - Connect affordability decisions with existing SpendingStreak model
    - Use existing BudgetViewModel.updateStreak() method for AI-enhanced streak protection
    - Add streak impact warnings using existing streak calculation logic
    - Create unit tests that validate streak integration with existing streak system
    - _Requirements: 3.4, 4.4_

- [ ] 8. Implement Swift Apple Foundation Models GPT-5 learning and improvement system
  - [ ] 8.1 Create Swift user feedback collection for Foundation Models GPT-5 price accuracy
    - Add Swift interface for users to correct Apple Foundation Models GPT-5 price estimates
    - Implement Swift on-device learning using Foundation Models GPT-5 feedback mechanisms
    - Create privacy-preserving Swift Foundation Models update workflows
    - Write Swift unit tests for Foundation Models GPT-5 learning accuracy improvements
    - _Requirements: 6.1, 6.5_

  - [ ] 8.2 Build Swift Foundation Models GPT-5 behavioral pattern recognition
    - Implement Swift Apple Foundation Models GPT-5 algorithms that learn from user purchase decisions
    - Add Foundation Models GPT-5 powered location-based price adjustment learning in Swift
    - Create category-specific accuracy improvements using Swift Foundation Models GPT-5 capabilities
    - Add comprehensive Swift testing for Foundation Models GPT-5 learning effectiveness
    - _Requirements: 6.2, 6.3, 6.4_

- [ ] 9. Add camera interface enhancements and error handling
  - [ ] 9.1 Implement adaptive camera settings for different conditions
    - Add automatic low-light detection and camera adjustment
    - Implement multi-object detection with tap-to-select functionality
    - Create helpful guidance for optimal object positioning
    - Add comprehensive error handling with user-friendly messages
    - _Requirements: 5.1, 5.2, 5.4_

  - [ ] 9.2 Optimize performance for real-time processing
    - Implement frame rate throttling for battery optimization
    - Add background processing queues for AI analysis
    - Create efficient memory management for continuous camera operation
    - Add performance monitoring and optimization tests
    - _Requirements: 5.1, 5.3_

- [ ] 10. Integrate with main app navigation and add final polish
  - [ ] 10.1 Add camera scanner to main app navigation
    - Create new tab or prominent access point in existing TabView
    - Integrate camera feature with existing app permissions flow
    - Add feature discovery and onboarding for new users
    - Write UI tests for complete user journey
    - _Requirements: 1.1, 3.1_

  - [ ] 10.2 Implement comprehensive testing and polish
    - Create end-to-end tests covering complete affordability scanning flow
    - Add accessibility testing with VoiceOver and Dynamic Type
    - Implement error recovery testing for various failure scenarios
    - Add performance testing for battery usage and memory efficiency
    - Create user acceptance testing scenarios
    - _Requirements: All requirements validation_